<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-02-25">

<title>Apprendre tidiverse : Maîtriser les dates en R avec lubridate – Anassé Yahanan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Anassé Yahanan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../page-projet/news1.html"> 
<span class="menu-text">Mon portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">Mon CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Apprendre tidiverse : Maîtriser les dates en R avec lubridate</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Data Science</div>
                <div class="quarto-category">Dates</div>
                <div class="quarto-category">lubridate</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 25, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pourquoi-maîtriser-les-dates-en-r" id="toc-pourquoi-maîtriser-les-dates-en-r" class="nav-link active" data-scroll-target="#pourquoi-maîtriser-les-dates-en-r">Pourquoi maîtriser les dates en R ?</a></li>
  <li><a href="#les-bases-de-lubridate" id="toc-les-bases-de-lubridate" class="nav-link" data-scroll-target="#les-bases-de-lubridate">1. Les bases de lubridate</a>
  <ul class="collapse">
  <li><a href="#installation-et-chargement" id="toc-installation-et-chargement" class="nav-link" data-scroll-target="#installation-et-chargement">Installation et chargement</a></li>
  <li><a href="#création-de-dates-lapproche-intuitive" id="toc-création-de-dates-lapproche-intuitive" class="nav-link" data-scroll-target="#création-de-dates-lapproche-intuitive">Création de dates : l’approche intuitive</a></li>
  <li><a href="#intégration-de-lheure" id="toc-intégration-de-lheure" class="nav-link" data-scroll-target="#intégration-de-lheure">Intégration de l’heure</a></li>
  </ul></li>
  <li><a href="#extraire-et-modifier-les-composants-dune-date" id="toc-extraire-et-modifier-les-composants-dune-date" class="nav-link" data-scroll-target="#extraire-et-modifier-les-composants-dune-date">2. Extraire et modifier les composants d’une date</a>
  <ul class="collapse">
  <li><a href="#extraction-dinformations" id="toc-extraction-dinformations" class="nav-link" data-scroll-target="#extraction-dinformations">Extraction d’informations</a></li>
  <li><a href="#modification-des-composants" id="toc-modification-des-composants" class="nav-link" data-scroll-target="#modification-des-composants">Modification des composants</a></li>
  </ul></li>
  <li><a href="#arithmétique-des-dates" id="toc-arithmétique-des-dates" class="nav-link" data-scroll-target="#arithmétique-des-dates">3. Arithmétique des dates</a></li>
  <li><a href="#projet-pratique-analyse-des-ventes-dune-chaîne-de-magasins" id="toc-projet-pratique-analyse-des-ventes-dune-chaîne-de-magasins" class="nav-link" data-scroll-target="#projet-pratique-analyse-des-ventes-dune-chaîne-de-magasins">4. Projet pratique : Analyse des ventes d’une chaîne de magasins</a>
  <ul class="collapse">
  <li><a href="#génération-des-données-de-vente" id="toc-génération-des-données-de-vente" class="nav-link" data-scroll-target="#génération-des-données-de-vente">4.1 Génération des données de vente</a></li>
  <li><a href="#exploration-des-données-temporelles" id="toc-exploration-des-données-temporelles" class="nav-link" data-scroll-target="#exploration-des-données-temporelles">4.2 Exploration des données temporelles</a></li>
  <li><a href="#analyse-des-tendances-mensuelles" id="toc-analyse-des-tendances-mensuelles" class="nav-link" data-scroll-target="#analyse-des-tendances-mensuelles">4.3 Analyse des tendances mensuelles</a></li>
  <li><a href="#comparaison-des-jours-de-la-semaine" id="toc-comparaison-des-jours-de-la-semaine" class="nav-link" data-scroll-target="#comparaison-des-jours-de-la-semaine">4.4 Comparaison des jours de la semaine</a></li>
  <li><a href="#analyse-des-tendances-saisonnières" id="toc-analyse-des-tendances-saisonnières" class="nav-link" data-scroll-target="#analyse-des-tendances-saisonnières">4.5 Analyse des tendances saisonnières</a></li>
  <li><a href="#analyse-des-ventes-par-magasin-dans-le-temps" id="toc-analyse-des-ventes-par-magasin-dans-le-temps" class="nav-link" data-scroll-target="#analyse-des-ventes-par-magasin-dans-le-temps">4.6 Analyse des ventes par magasin dans le temps</a></li>
  <li><a href="#identification-de-jours-spéciaux" id="toc-identification-de-jours-spéciaux" class="nav-link" data-scroll-target="#identification-de-jours-spéciaux">4.7 Identification de jours spéciaux</a></li>
  <li><a href="#analyse-des-intervalles-entre-pics-de-vente" id="toc-analyse-des-intervalles-entre-pics-de-vente" class="nav-link" data-scroll-target="#analyse-des-intervalles-entre-pics-de-vente">4.8 Analyse des intervalles entre pics de vente</a></li>
  <li><a href="#prévision-simple-basée-sur-les-tendances-historiques" id="toc-prévision-simple-basée-sur-les-tendances-historiques" class="nav-link" data-scroll-target="#prévision-simple-basée-sur-les-tendances-historiques">4.9 Prévision simple basée sur les tendances historiques</a></li>
  </ul></li>
  <li><a href="#applications-pratiques-avancées-avec-lubridate" id="toc-applications-pratiques-avancées-avec-lubridate" class="nav-link" data-scroll-target="#applications-pratiques-avancées-avec-lubridate">5. Applications pratiques avancées avec lubridate</a>
  <ul class="collapse">
  <li><a href="#création-de-périodes-glissantes-rolling-periods" id="toc-création-de-périodes-glissantes-rolling-periods" class="nav-link" data-scroll-target="#création-de-périodes-glissantes-rolling-periods">5.1 Création de périodes glissantes (rolling periods)</a></li>
  <li><a href="#calcul-dintervalles-entre-événements" id="toc-calcul-dintervalles-entre-événements" class="nav-link" data-scroll-target="#calcul-dintervalles-entre-événements">5.2 Calcul d’intervalles entre événements</a></li>
  <li><a href="#analyse-par-saison-commerciale" id="toc-analyse-par-saison-commerciale" class="nav-link" data-scroll-target="#analyse-par-saison-commerciale">5.3 Analyse par saison commerciale</a></li>
  </ul></li>
  <li><a href="#conseils-pratiques-pour-travailler-avec-les-dates" id="toc-conseils-pratiques-pour-travailler-avec-les-dates" class="nav-link" data-scroll-target="#conseils-pratiques-pour-travailler-avec-les-dates">6. Conseils pratiques pour travailler avec les dates</a>
  <ul class="collapse">
  <li><a href="#formatage-des-dates-pour-affichage" id="toc-formatage-des-dates-pour-affichage" class="nav-link" data-scroll-target="#formatage-des-dates-pour-affichage">6.1 Formatage des dates pour affichage</a></li>
  <li><a href="#gestion-des-fuseaux-horaires" id="toc-gestion-des-fuseaux-horaires" class="nav-link" data-scroll-target="#gestion-des-fuseaux-horaires">6.2 Gestion des fuseaux horaires</a></li>
  <li><a href="#traitement-des-données-manquantes-dans-les-dates" id="toc-traitement-des-données-manquantes-dans-les-dates" class="nav-link" data-scroll-target="#traitement-des-données-manquantes-dans-les-dates">6.3 Traitement des données manquantes dans les dates</a></li>
  </ul></li>
  <li><a href="#conclusion-et-bonnes-pratiques" id="toc-conclusion-et-bonnes-pratiques" class="nav-link" data-scroll-target="#conclusion-et-bonnes-pratiques">7. Conclusion et bonnes pratiques</a>
  <ul class="collapse">
  <li><a href="#points-clés-à-retenir" id="toc-points-clés-à-retenir" class="nav-link" data-scroll-target="#points-clés-à-retenir">Points clés à retenir</a></li>
  </ul></li>
  <li><a href="#pour-aller-plus-loin" id="toc-pour-aller-plus-loin" class="nav-link" data-scroll-target="#pour-aller-plus-loin">Pour aller plus loin</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="pourquoi-maîtriser-les-dates-en-r" class="level2">
<h2 class="anchored" data-anchor-id="pourquoi-maîtriser-les-dates-en-r">Pourquoi maîtriser les dates en R ?</h2>
<p>Les analyses de données commerciales, financières ou marketing impliquent presque toujours une dimension temporelle. Savoir manipuler efficacement les dates est donc une compétence indispensable pour tout analyste de données utilisant R. Dans ce tutoriel, nous allons :</p>
<ol type="1">
<li>Explorer les fonctionnalités essentielles du package <code>lubridate</code></li>
<li>Appliquer ces connaissances à un projet complet d’analyse de données de vente</li>
</ol>
</section>
<section id="les-bases-de-lubridate" class="level2">
<h2 class="anchored" data-anchor-id="les-bases-de-lubridate">1. Les bases de lubridate</h2>
<section id="installation-et-chargement" class="level3">
<h3 class="anchored" data-anchor-id="installation-et-chargement">Installation et chargement</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installation (à faire une seule fois)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"lubridate"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="création-de-dates-lapproche-intuitive" class="level3">
<h3 class="anchored" data-anchor-id="création-de-dates-lapproche-intuitive">Création de dates : l’approche intuitive</h3>
<p>La force de <code>lubridate</code> réside dans sa syntaxe intuitive. Pour créer une date, il suffit d’utiliser une fonction dont le nom correspond à l’ordre des éléments.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Format année-mois-jour</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Format jour-mois-année</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy</span>(<span class="st">"25-02-2025"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Format mois-jour-année (format américain)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mdy</span>(<span class="st">"02/25/2025"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonctionne avec différents séparateurs ou sans</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025.02.25"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"20250225"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Les fonctions de création de date acceptent de nombreux formats et séparateurs, ce qui facilite le nettoyage des données importées de diverses sources.</p>
</div>
</div>
</section>
<section id="intégration-de-lheure" class="level3">
<h3 class="anchored" data-anchor-id="intégration-de-lheure">Intégration de l’heure</h3>
<p>Pour inclure l’heure, ajoutez simplement le suffixe correspondant :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Année-mois-jour heure-minute-seconde</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(<span class="st">"2025-02-25 14:30:45"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25 14:30:45 UTC"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jour-mois-année heure-minute</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy_hm</span>(<span class="st">"25-02-2025 14:30"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25 14:30:00 UTC"</code></pre>
</div>
</div>
</section>
</section>
<section id="extraire-et-modifier-les-composants-dune-date" class="level2">
<h2 class="anchored" data-anchor-id="extraire-et-modifier-les-composants-dune-date">2. Extraire et modifier les composants d’une date</h2>
<section id="extraction-dinformations" class="level3">
<h3 class="anchored" data-anchor-id="extraction-dinformations">Extraction d’informations</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'une date</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ma_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des composants</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(ma_date)    <span class="co"># Année</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2025</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(ma_date)   <span class="co"># Mois (numérique)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(ma_date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)  <span class="co"># Nom du mois complet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] février
12 Levels: janvier &lt; février &lt; mars &lt; avril &lt; mai &lt; juin &lt; juillet &lt; ... &lt; décembre</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">day</span>(ma_date)     <span class="co"># Jour du mois</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(ma_date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">week_start =</span> <span class="dv">1</span>)  <span class="co"># Jour de la semaine (débutant lundi)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] mar\\.
Levels: lun\\. &lt; mar\\. &lt; mer\\. &lt; jeu\\. &lt; ven\\. &lt; sam\\. &lt; dim\\.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quarter</span>(ma_date) <span class="co"># Trimestre</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="modification-des-composants" class="level3">
<h3 class="anchored" data-anchor-id="modification-des-composants">Modification des composants</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copier la date pour démonstration</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>date_modifiee <span class="ot">&lt;-</span> ma_date</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Modification de l'année</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(date_modifiee) <span class="ot">&lt;-</span> <span class="dv">2026</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>date_modifiee</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-02-25"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modification du mois (en une ligne)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>date_modifiee <span class="ot">&lt;-</span> date_modifiee <span class="sc">%&gt;%</span> <span class="fu">month</span>(<span class="dv">5</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>date_modifiee</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] févr
12 Levels: janv &lt; févr &lt; mars &lt; avr &lt; mai &lt; juin &lt; juil &lt; août &lt; ... &lt; déc</code></pre>
</div>
</div>
</section>
</section>
<section id="arithmétique-des-dates" class="level2">
<h2 class="anchored" data-anchor-id="arithmétique-des-dates">3. Arithmétique des dates</h2>
<p>L’un des grands avantages de <code>lubridate</code> est la simplicité des opérations arithmétiques :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ma_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter différentes unités de temps</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-03-07"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">weeks</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-03-11"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-05-25"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-02-25"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinaison d'opérations</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-04-02"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Différence entre deux dates</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>date1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-01-15"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>date2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-03-25"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">interval</span>(date1, date2)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.period</span>(interval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2m 10d 0H 0M 0S"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Attention à la différence entre <code>period</code> et <code>duration</code> ! - <code>months(1)</code> (période) : ajoute un mois calendaire (variable selon le mois) - <code>dmonths(1)</code> (durée) : ajoute exactement 30.44 jours</p>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Démonstration de la différence</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025-01-31"</span>) <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>)  <span class="co"># Respecte le calendrier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025-01-31"</span>) <span class="sc">+</span> <span class="fu">dmonths</span>(<span class="dv">1</span>)  <span class="co"># Ajoute une durée fixe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-03-02 10:30:00 UTC"</code></pre>
</div>
</div>
</section>
<section id="projet-pratique-analyse-des-ventes-dune-chaîne-de-magasins" class="level2">
<h2 class="anchored" data-anchor-id="projet-pratique-analyse-des-ventes-dune-chaîne-de-magasins">4. Projet pratique : Analyse des ventes d’une chaîne de magasins</h2>
<p>Maintenant, appliquons ces connaissances à un projet concret. Nous allons analyser les données de vente d’une chaîne de magasins fictive pour identifier les tendances saisonnières et les opportunités commerciales.</p>
<section id="génération-des-données-de-vente" class="level3">
<h3 class="anchored" data-anchor-id="génération-des-données-de-vente">4.1 Génération des données de vente</h3>
<p>Commençons par créer un jeu de données réaliste :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour générer des ventes avec patterns saisonniers</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>generer_ventes <span class="ot">&lt;-</span> <span class="cf">function</span>(n_jours, date_debut) {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Séquence de dates</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(date_debut), <span class="fu">ymd</span>(date_debut) <span class="sc">+</span> <span class="fu">days</span>(n_jours <span class="sc">-</span> <span class="dv">1</span>), <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tendance générale à la hausse</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  tendance <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, n_jours) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Saisonnalité hebdomadaire (weekend +)</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  saisonnalite_hebdo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">wday</span>(dates) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="dv">2000</span>, <span class="dv">0</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Saisonnalité mensuelle (fin de mois +)</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  saisonnalite_mensuelle <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">day</span>(dates) <span class="sc">&gt;=</span> <span class="dv">25</span>, <span class="dv">1000</span>, <span class="dv">0</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Saisonnalité annuelle (été et Noël +)</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">month</span>(dates)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  saisonnalite_annuelle <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    mois <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="dv">3000</span>,  <span class="co"># Été</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    mois <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="dv">5000</span>,         <span class="co"># Noël</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    mois <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">1000</span>,         <span class="co"># Janvier (après Noël)</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Valeurs de base avec bruit aléatoire</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  base <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  bruit <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_jours, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Génération des ventes journalières</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  ventes <span class="ot">&lt;-</span> base <span class="sc">+</span> tendance <span class="sc">+</span> saisonnalite_hebdo <span class="sc">+</span> saisonnalite_mensuelle <span class="sc">+</span> </span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    saisonnalite_annuelle <span class="sc">+</span> bruit</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du dataframe</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> dates,</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes =</span> <span class="fu">round</span>(<span class="fu">pmax</span>(ventes, <span class="dv">0</span>)),</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">magasin =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Paris"</span>, <span class="st">"Lyon"</span>, <span class="st">"Marseille"</span>, <span class="st">"Bordeaux"</span>, <span class="st">"Lille"</span>), n_jours, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de deux ans de données</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>ventes <span class="ot">&lt;-</span> <span class="fu">generer_ventes</span>(<span class="dv">730</span>, <span class="st">"2023-01-01"</span>)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Aperçu des données</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ventes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        date ventes  magasin
1 2023-01-01  10445    Paris
2 2023-01-02   8780 Bordeaux
3 2023-01-03  10574    Lille
4 2023-01-04   9091     Lyon
5 2023-01-05   9154    Paris
6 2023-01-06  10745 Bordeaux</code></pre>
</div>
</div>
</section>
<section id="exploration-des-données-temporelles" class="level3">
<h3 class="anchored" data-anchor-id="exploration-des-données-temporelles">4.2 Exploration des données temporelles</h3>
<p>Préparons les données en ajoutant des dimensions temporelles utiles :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enrichissement des données avec composantes temporelles</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>ventes_enrichies <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">annee =</span> <span class="fu">year</span>(date),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mois =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trimestre =</span> <span class="fu">quarter</span>(date),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">semaine =</span> <span class="fu">week</span>(date),</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">jour_semaine =</span> <span class="fu">wday</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">week_start =</span> <span class="dv">1</span>),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">jour_mois =</span> <span class="fu">day</span>(date),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">weekend =</span> <span class="fu">ifelse</span>(<span class="fu">wday</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="st">"Weekend"</span>, <span class="st">"Semaine"</span>),</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">saison =</span> <span class="fu">case_when</span>(</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Hiver"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Printemps"</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Été"</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Automne"</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure des données enrichies</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ventes_enrichies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 730
Columns: 11
$ date         &lt;date&gt; 2023-01-01, 2023-01-02, 2023-01-03, 2023-01-04, 2023-01-…
$ ventes       &lt;dbl&gt; 10445, 8780, 10574, 9091, 9154, 10745, 11496, 9775, 8358,…
$ magasin      &lt;chr&gt; "Paris", "Bordeaux", "Lille", "Lyon", "Paris", "Bordeaux"…
$ annee        &lt;dbl&gt; 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 202…
$ mois         &lt;ord&gt; janv, janv, janv, janv, janv, janv, janv, janv, janv, jan…
$ trimestre    &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ semaine      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, …
$ jour_semaine &lt;ord&gt; dim\., lun\., mar\., mer\., jeu\., ven\., sam\., dim\., l…
$ jour_mois    &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…
$ weekend      &lt;chr&gt; "Weekend", "Semaine", "Semaine", "Semaine", "Semaine", "S…
$ saison       &lt;chr&gt; "Hiver", "Hiver", "Hiver", "Hiver", "Hiver", "Hiver", "Hi…</code></pre>
</div>
</div>
</section>
<section id="analyse-des-tendances-mensuelles" class="level3">
<h3 class="anchored" data-anchor-id="analyse-des-tendances-mensuelles">4.3 Analyse des tendances mensuelles</h3>
<p>Analysons maintenant l’évolution mensuelle des ventes :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes mensuelles</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ventes_mensuelles <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, mois) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_mensuelles, <span class="fu">aes</span>(<span class="at">x =</span> mois, <span class="at">y =</span> ventes_totales, <span class="at">fill =</span> <span class="fu">factor</span>(annee))) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes mensuelles par année"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mois"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes totales"</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Année"</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidyverse-guide_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparaison-des-jours-de-la-semaine" class="level3">
<h3 class="anchored" data-anchor-id="comparaison-des-jours-de-la-semaine">4.4 Comparaison des jours de la semaine</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes par jour de semaine</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ventes_jour_semaine <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(jour_semaine, weekend) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_moyennes =</span> <span class="fu">mean</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_jour_semaine, <span class="fu">aes</span>(<span class="at">x =</span> jour_semaine, <span class="at">y =</span> ventes_moyennes, <span class="at">fill =</span> weekend)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes moyennes par jour de la semaine"</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Jour"</span>,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes moyennes"</span>,</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Type de jour"</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidyverse-guide_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analyse-des-tendances-saisonnières" class="level3">
<h3 class="anchored" data-anchor-id="analyse-des-tendances-saisonnières">4.5 Analyse des tendances saisonnières</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes par saison et par année</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>ventes_saison <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, saison) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Réordonner les saisons</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>ventes_saison<span class="sc">$</span>saison <span class="ot">&lt;-</span> <span class="fu">factor</span>(ventes_saison<span class="sc">$</span>saison, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Printemps"</span>, <span class="st">"Été"</span>, <span class="st">"Automne"</span>, <span class="st">"Hiver"</span>))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_saison, <span class="fu">aes</span>(<span class="at">x =</span> saison, <span class="at">y =</span> ventes_totales, <span class="at">fill =</span> <span class="fu">factor</span>(annee))) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes totales par saison"</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Saison"</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes totales"</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Année"</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidyverse-guide_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analyse-des-ventes-par-magasin-dans-le-temps" class="level3">
<h3 class="anchored" data-anchor-id="analyse-des-ventes-par-magasin-dans-le-temps">4.6 Analyse des ventes par magasin dans le temps</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes mensuelles par magasin</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>ventes_magasin <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, mois, magasin) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fusion année-mois pour la visualisation</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>ventes_magasin <span class="ot">&lt;-</span> ventes_magasin <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">periode =</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(annee, <span class="st">"-"</span>, <span class="fu">as.numeric</span>(mois), <span class="st">"-01"</span>)))</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_magasin, <span class="fu">aes</span>(<span class="at">x =</span> periode, <span class="at">y =</span> ventes_totales, <span class="at">color =</span> magasin)) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>, <span class="at">date_breaks =</span> <span class="st">"2 months"</span>) <span class="sc">+</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Évolution des ventes par magasin"</span>,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Période"</span>,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes totales"</span>,</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Magasin"</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidyverse-guide_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="identification-de-jours-spéciaux" class="level3">
<h3 class="anchored" data-anchor-id="identification-de-jours-spéciaux">4.7 Identification de jours spéciaux</h3>
<p>Analysons les jours de vente exceptionnels :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des jours exceptionnels (ventes supérieures à la moyenne + 2 écarts-types)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>moyenne_ventes <span class="ot">&lt;-</span> <span class="fu">mean</span>(ventes_enrichies<span class="sc">$</span>ventes)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>ecart_type_ventes <span class="ot">&lt;-</span> <span class="fu">sd</span>(ventes_enrichies<span class="sc">$</span>ventes)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>seuil_exceptionnel <span class="ot">&lt;-</span> moyenne_ventes <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> ecart_type_ventes</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>jours_exceptionnels <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ventes <span class="sc">&gt;</span> seuil_exceptionnel) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ventes))</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des 10 meilleurs jours de vente</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(jours_exceptionnels <span class="sc">%&gt;%</span> </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(date, jour_semaine, mois, ventes, magasin), <span class="dv">10</span>),</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Top 10 des jours de vente exceptionnels"</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">" "</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 10 des jours de vente exceptionnels</caption>
<thead>
<tr class="header">
<th style="text-align: left;">date</th>
<th style="text-align: left;">jour_semaine</th>
<th style="text-align: left;">mois</th>
<th style="text-align: right;">ventes</th>
<th style="text-align: left;">magasin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2024-12-15</td>
<td style="text-align: left;">dim.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">22 016</td>
<td style="text-align: left;">Marseille</td>
</tr>
<tr class="even">
<td style="text-align: left;">2024-12-28</td>
<td style="text-align: left;">sam.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">21 829</td>
<td style="text-align: left;">Marseille</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2024-12-29</td>
<td style="text-align: left;">dim.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 912</td>
<td style="text-align: left;">Lyon</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-12-30</td>
<td style="text-align: left;">sam.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 845</td>
<td style="text-align: left;">Bordeaux</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2024-12-07</td>
<td style="text-align: left;">sam.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 824</td>
<td style="text-align: left;">Lille</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-12-31</td>
<td style="text-align: left;">dim.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 643</td>
<td style="text-align: left;">Marseille</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2024-12-30</td>
<td style="text-align: left;">lun.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 636</td>
<td style="text-align: left;">Paris</td>
</tr>
<tr class="even">
<td style="text-align: left;">2024-12-14</td>
<td style="text-align: left;">sam.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 483</td>
<td style="text-align: left;">Marseille</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2023-12-09</td>
<td style="text-align: left;">sam.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 386</td>
<td style="text-align: left;">Paris</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-12-26</td>
<td style="text-align: left;">mar.</td>
<td style="text-align: left;">déc</td>
<td style="text-align: right;">20 371</td>
<td style="text-align: left;">Bordeaux</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analyse-des-intervalles-entre-pics-de-vente" class="level3">
<h3 class="anchored" data-anchor-id="analyse-des-intervalles-entre-pics-de-vente">4.8 Analyse des intervalles entre pics de vente</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalles entre jours exceptionnels</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>jours_pic <span class="ot">&lt;-</span> jours_exceptionnels <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(date)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des intervalles (en jours)</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>intervalles <span class="ot">&lt;-</span> <span class="fu">diff</span>(jours_pic)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques sur les intervalles</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>resume_intervalles <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_min =</span> <span class="fu">min</span>(intervalles),</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_median =</span> <span class="fu">median</span>(intervalles),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_moyen =</span> <span class="fu">mean</span>(intervalles),</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_max =</span> <span class="fu">max</span>(intervalles)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(resume_intervalles, </span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Statistiques sur les intervalles entre pics de vente (en jours)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Statistiques sur les intervalles entre pics de vente (en jours)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">intervalle_min</th>
<th style="text-align: left;">intervalle_median</th>
<th style="text-align: left;">intervalle_moyen</th>
<th style="text-align: left;">intervalle_max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1 days</td>
<td style="text-align: left;">1 days</td>
<td style="text-align: left;">11.72727 days</td>
<td style="text-align: left;">188 days</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="prévision-simple-basée-sur-les-tendances-historiques" class="level3">
<h3 class="anchored" data-anchor-id="prévision-simple-basée-sur-les-tendances-historiques">4.9 Prévision simple basée sur les tendances historiques</h3>
<p>Nous pouvons utiliser lubridate pour extrapoler les ventes futures en nous basant sur les patterns saisonniers identifiés :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de dates futures pour prévision</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>dates_futures <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">max</span>(ventes<span class="sc">$</span>date) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>), </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">max</span>(ventes<span class="sc">$</span>date) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">30</span>), <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation du dataframe pour les prévisions</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>previsions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> dates_futures,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">jour_semaine =</span> <span class="fu">wday</span>(dates_futures, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mois =</span> <span class="fu">month</span>(dates_futures, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">jour_mois =</span> <span class="fu">day</span>(dates_futures)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Application des facteurs saisonniers identifiés</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>previsions <span class="ot">&lt;-</span> previsions <span class="sc">%&gt;%</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">facteur_weekend =</span> <span class="fu">ifelse</span>(<span class="fu">wday</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="fl">1.2</span>, <span class="dv">1</span>),</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">facteur_fin_mois =</span> <span class="fu">ifelse</span>(jour_mois <span class="sc">&gt;=</span> <span class="dv">25</span>, <span class="fl">1.1</span>, <span class="dv">1</span>),</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">facteur_mois =</span> <span class="fu">case_when</span>(</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>      mois <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"juil."</span>, <span class="st">"août"</span>) <span class="sc">~</span> <span class="fl">1.3</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>      mois <span class="sc">==</span> <span class="st">"déc."</span> <span class="sc">~</span> <span class="fl">1.5</span>,</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>      mois <span class="sc">==</span> <span class="st">"janv."</span> <span class="sc">~</span> <span class="fl">0.9</span>,</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_prevues =</span> <span class="dv">15000</span> <span class="sc">*</span> facteur_weekend <span class="sc">*</span> facteur_fin_mois <span class="sc">*</span> facteur_mois</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Aperçu des prévisions</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(previsions <span class="sc">%&gt;%</span> </span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(date, jour_semaine, ventes_prevues), <span class="dv">10</span>),</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Prévision des ventes pour les 10 prochains jours"</span>,</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">" "</span>)</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Prévision des ventes pour les 10 prochains jours</caption>
<thead>
<tr class="header">
<th style="text-align: left;">date</th>
<th style="text-align: left;">jour_semaine</th>
<th style="text-align: right;">ventes_prevues</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2024-12-31</td>
<td style="text-align: left;">mar.</td>
<td style="text-align: right;">16 500</td>
</tr>
<tr class="even">
<td style="text-align: left;">2025-01-01</td>
<td style="text-align: left;">mer.</td>
<td style="text-align: right;">15 000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2025-01-02</td>
<td style="text-align: left;">jeu.</td>
<td style="text-align: right;">15 000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2025-01-03</td>
<td style="text-align: left;">ven.</td>
<td style="text-align: right;">15 000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2025-01-04</td>
<td style="text-align: left;">sam.</td>
<td style="text-align: right;">18 000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2025-01-05</td>
<td style="text-align: left;">dim.</td>
<td style="text-align: right;">18 000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2025-01-06</td>
<td style="text-align: left;">lun.</td>
<td style="text-align: right;">15 000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2025-01-07</td>
<td style="text-align: left;">mar.</td>
<td style="text-align: right;">15 000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2025-01-08</td>
<td style="text-align: left;">mer.</td>
<td style="text-align: right;">15 000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2025-01-09</td>
<td style="text-align: left;">jeu.</td>
<td style="text-align: right;">15 000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="applications-pratiques-avancées-avec-lubridate" class="level2">
<h2 class="anchored" data-anchor-id="applications-pratiques-avancées-avec-lubridate">5. Applications pratiques avancées avec lubridate</h2>
<section id="création-de-périodes-glissantes-rolling-periods" class="level3">
<h3 class="anchored" data-anchor-id="création-de-périodes-glissantes-rolling-periods">5.1 Création de périodes glissantes (rolling periods)</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des moyennes mobiles sur 7 jours</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>ventes_moyennes_mobiles <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_moy_7j =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(ventes, <span class="at">k =</span> <span class="dv">7</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">periode_debut =</span> date <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">6</span>),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">periode_fin =</span> date</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des dernières 30 observations</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>tail_ventes <span class="ot">&lt;-</span> <span class="fu">tail</span>(ventes_moyennes_mobiles, <span class="dv">30</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tail_ventes, <span class="fu">aes</span>(<span class="at">x =</span> date)) <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ventes), <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ventes_moy_7j), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes quotidiennes vs. moyenne mobile sur 7 jours"</span>,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"30 derniers jours d'observation"</span>,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes"</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidyverse-guide_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calcul-dintervalles-entre-événements" class="level3">
<h3 class="anchored" data-anchor-id="calcul-dintervalles-entre-événements">5.2 Calcul d’intervalles entre événements</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identification des jours où les ventes dépassent 20 000 €</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>jours_20k <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ventes <span class="sc">&gt;</span> <span class="dv">20000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(date)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des intervalles entre ces jours</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>intervalles_20k <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_debut =</span> <span class="fu">head</span>(jours_20k, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_fin =</span> <span class="fu">tail</span>(jours_20k, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle =</span> <span class="fu">as.numeric</span>(<span class="fu">diff</span>(jours_20k))</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des 5 premiers intervalles</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(intervalles_20k, <span class="dv">5</span>),</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Intervalles (en jours) entre les ventes dépassant 20 000 €"</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Intervalles (en jours) entre les ventes dépassant 20 000 €</caption>
<thead>
<tr class="header">
<th style="text-align: left;">date_debut</th>
<th style="text-align: left;">date_fin</th>
<th style="text-align: right;">intervalle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2023-12-09</td>
<td style="text-align: left;">2023-12-26</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-12-26</td>
<td style="text-align: left;">2023-12-30</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2023-12-30</td>
<td style="text-align: left;">2023-12-31</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2023-12-31</td>
<td style="text-align: left;">2024-12-07</td>
<td style="text-align: right;">342</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2024-12-07</td>
<td style="text-align: left;">2024-12-14</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analyse-par-saison-commerciale" class="level3">
<h3 class="anchored" data-anchor-id="analyse-par-saison-commerciale">5.3 Analyse par saison commerciale</h3>
<p>Définissons des saisons commerciales personnalisées et analysons les performances :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des périodes commerciales</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>periodes_commerciales <span class="ot">&lt;-</span> <span class="cf">function</span>(date) {</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span> <span class="fu">day</span>(date) <span class="sc">&gt;=</span> <span class="dv">25</span>) <span class="sc">|</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">month</span>(date) <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span> <span class="fu">day</span>(date) <span class="sc">&lt;=</span> <span class="dv">31</span>) <span class="sc">~</span> <span class="st">"Fêtes de fin d'année"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> <span class="fu">month</span>(date) <span class="sc">&lt;=</span> <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Période estivale"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">month</span>(date) <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Soldes d'hiver"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> <span class="fu">month</span>(date) <span class="sc">&lt;=</span> <span class="dv">7</span> <span class="sc">&amp;</span> <span class="fu">day</span>(date) <span class="sc">&lt;=</span> <span class="dv">15</span>) <span class="sc">~</span> <span class="st">"Soldes d'été"</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Période normale"</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Application à nos données</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>ventes_periodes <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">periode_commerciale =</span> <span class="fu">periodes_commerciales</span>(date))</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse des ventes par période commerciale</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>resume_periodes <span class="ot">&lt;-</span> ventes_periodes <span class="sc">%&gt;%</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(periode_commerciale) <span class="sc">%&gt;%</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes),</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_moyennes =</span> <span class="fu">mean</span>(ventes),</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_jours =</span> <span class="fu">n</span>()</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ventes_moyennes))</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>  resume_periodes,</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Performance des ventes par période commerciale"</span>,</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">" "</span>)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Performance des ventes par période commerciale</caption>
<thead>
<tr class="header">
<th style="text-align: left;">periode_commerciale</th>
<th style="text-align: right;">ventes_totales</th>
<th style="text-align: right;">ventes_moyennes</th>
<th style="text-align: right;">nb_jours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fêtes de fin d’année</td>
<td style="text-align: right;">1 295 373</td>
<td style="text-align: right;">17 744.84</td>
<td style="text-align: right;">73</td>
</tr>
<tr class="even">
<td style="text-align: left;">Période estivale</td>
<td style="text-align: right;">2 707 913</td>
<td style="text-align: right;">14 716.92</td>
<td style="text-align: right;">184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Période normale</td>
<td style="text-align: right;">4 472 982</td>
<td style="text-align: right;">12 635.54</td>
<td style="text-align: right;">354</td>
</tr>
<tr class="even">
<td style="text-align: left;">Soldes d’hiver</td>
<td style="text-align: right;">1 341 800</td>
<td style="text-align: right;">11 275.63</td>
<td style="text-align: right;">119</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="conseils-pratiques-pour-travailler-avec-les-dates" class="level2">
<h2 class="anchored" data-anchor-id="conseils-pratiques-pour-travailler-avec-les-dates">6. Conseils pratiques pour travailler avec les dates</h2>
<section id="formatage-des-dates-pour-affichage" class="level3">
<h3 class="anchored" data-anchor-id="formatage-des-dates-pour-affichage">6.1 Formatage des dates pour affichage</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemples de formatage</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>ma_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>formats <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%d/%m/%Y"</span>, </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%A %d %B %Y"</span>, </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%d %b %Y"</span>, </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Semaine %U, %Y"</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Application des différents formats</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>formats_affiches <span class="ot">&lt;-</span> <span class="fu">sapply</span>(formats, <span class="cf">function</span>(fmt) <span class="fu">format</span>(ma_date, fmt))</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Format =</span> formats,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  Résultat <span class="ot">=</span> formats_affiches</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       Format              Résultat
%d/%m/%Y             %d/%m/%Y            25/02/2025
%A %d %B %Y       %A %d %B %Y mardi 25 février 2025
%d %b %Y             %d %b %Y         25 févr. 2025
Semaine %U, %Y Semaine %U, %Y      Semaine 08, 2025</code></pre>
</div>
</div>
</section>
<section id="gestion-des-fuseaux-horaires" class="level3">
<h3 class="anchored" data-anchor-id="gestion-des-fuseaux-horaires">6.2 Gestion des fuseaux horaires</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'une date avec heure et fuseau horaire</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>date_paris <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2025-02-25 14:30:00"</span>, <span class="at">tz =</span> <span class="st">"Europe/Paris"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>date_paris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25 14:30:00 CET"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion vers d'autres fuseaux horaires</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>date_ny <span class="ot">&lt;-</span> <span class="fu">with_tz</span>(date_paris, <span class="at">tzone =</span> <span class="st">"America/New_York"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>date_tokyo <span class="ot">&lt;-</span> <span class="fu">with_tz</span>(date_paris, <span class="at">tzone =</span> <span class="st">"Asia/Tokyo"</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ville =</span> <span class="fu">c</span>(<span class="st">"Paris"</span>, <span class="st">"New York"</span>, <span class="st">"Tokyo"</span>),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Heure_locale =</span> <span class="fu">c</span>(</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_paris, <span class="st">"%H:%M:%S"</span>),</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_ny, <span class="st">"%H:%M:%S"</span>),</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_tokyo, <span class="st">"%H:%M:%S"</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">c</span>(</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_paris, <span class="st">"%d %b %Y"</span>),</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_ny, <span class="st">"%d %b %Y"</span>),</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_tokyo, <span class="st">"%d %b %Y"</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fuseau =</span> <span class="fu">c</span>(<span class="fu">tz</span>(date_paris), <span class="fu">tz</span>(date_ny), <span class="fu">tz</span>(date_tokyo))</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Ville Heure_locale          Date           Fuseau
1    Paris     14:30:00 25 févr. 2025     Europe/Paris
2 New York     08:30:00 25 févr. 2025 America/New_York
3    Tokyo     22:30:00 25 févr. 2025       Asia/Tokyo</code></pre>
</div>
</div>
</section>
<section id="traitement-des-données-manquantes-dans-les-dates" class="level3">
<h3 class="anchored" data-anchor-id="traitement-des-données-manquantes-dans-les-dates">6.3 Traitement des données manquantes dans les dates</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemple de dates avec valeurs manquantes</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>dates_avec_na <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"2025-02-25"</span>, <span class="cn">NA</span>, <span class="st">"2025-03-01"</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>dates_parsees <span class="ot">&lt;-</span> <span class="fu">ymd</span>(dates_avec_na)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>dates_parsees</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25" NA           "2025-03-01"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification des NA</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(dates_parsees)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE FALSE</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrage des NA</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>dates_parsees[<span class="sc">!</span><span class="fu">is.na</span>(dates_parsees)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-02-25" "2025-03-01"</code></pre>
</div>
</div>
</section>
</section>
<section id="conclusion-et-bonnes-pratiques" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-et-bonnes-pratiques">7. Conclusion et bonnes pratiques</h2>
<p>Le package <code>lubridate</code> offre une approche intuitive et puissante pour manipuler les dates en R, ce qui est essentiel pour l’analyse de données commerciales. Voici quelques bonnes pratiques à retenir :</p>
<ol type="1">
<li><strong>Cohérence des formats</strong> : Standardisez vos dates dès l’importation des données</li>
<li><strong>Enrichissez vos données</strong> : Ajoutez des dimensions temporelles pertinentes (jour de semaine, mois, saison…)</li>
<li><strong>Attention aux fuseaux horaires</strong> : Soyez explicite dans leur gestion, surtout pour les données internationales</li>
<li><strong>Pensez en périodes</strong> : Utilisez les concepts de <code>period</code> et <code>duration</code> selon vos besoins</li>
<li><strong>Évitez les calculs manuels</strong> : Utilisez les fonctions spécialisées (<code>interval</code>, <code>time_length</code>, etc.)</li>
</ol>
<section id="points-clés-à-retenir" class="level3">
<h3 class="anchored" data-anchor-id="points-clés-à-retenir">Points clés à retenir</h3>
<ul>
<li><strong>Création de dates</strong> : <code>ymd()</code>, <code>dmy()</code>, <code>mdy()</code></li>
<li><strong>Extraction de composants</strong> : <code>year()</code>, <code>month()</code>, <code>day()</code>, <code>wday()</code></li>
<li><strong>Opérations arithmétiques</strong> : <code>+ days()</code>, <code>+ months()</code>, <code>+ years()</code></li>
<li><strong>Intervalles</strong> : <code>interval()</code>, <code>as.period()</code>, <code>time_length()</code></li>
<li><strong>Arrondis</strong> : <code>round_date()</code>, <code>floor_date()</code>, <code>ceiling_date()</code></li>
</ul>
<p>Maîtriser ces fonctions vous permettra d’analyser efficacement la dimension temporelle de vos données commerciales et d’en extraire des insights précieux pour votre entreprise.</p>
</section>
</section>
<section id="pour-aller-plus-loin" class="level2">
<h2 class="anchored" data-anchor-id="pour-aller-plus-loin">Pour aller plus loin</h2>
<ul>
<li>La <a href="https://lubridate.tidyverse.org/">documentation officielle de lubridate</a></li>
<li>Le livre <a href="https://r4ds.hadley.nz/">R for Data Science</a> de Hadley Wickham</li>
<li>Les packages complémentaires : <code>tsibble</code> pour les séries temporelles, <code>timetk</code> pour l’analyse temporelle avancée</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb74" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Apprendre tidiverse : Maîtriser les dates en R avec lubridate"</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-02-25"</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Data Science, Dates, lubridate]</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "calendar.jpg"</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="in">library(lubridate)</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales)</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pourquoi maîtriser les dates en R ?</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>Les analyses de données commerciales, financières ou marketing impliquent presque toujours une dimension temporelle. Savoir manipuler efficacement les dates est donc une compétence indispensable pour tout analyste de données utilisant R. Dans ce tutoriel, nous allons :</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Explorer les fonctionnalités essentielles du package <span class="in">`lubridate`</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Appliquer ces connaissances à un projet complet d'analyse de données de vente</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Les bases de lubridate</span></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="fu">### Installation et chargement</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="in"># Installation (à faire une seule fois)</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="in">install.packages("lubridate")</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="in"># Chargement</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="in">library(lubridate)</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a><span class="fu">### Création de dates : l'approche intuitive</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>La force de <span class="in">`lubridate`</span> réside dans sa syntaxe intuitive. Pour créer une date, il suffit d'utiliser une fonction dont le nom correspond à l'ordre des éléments.</span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Format année-mois-jour</span></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Format jour-mois-année</span></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy</span>(<span class="st">"25-02-2025"</span>)</span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Format mois-jour-année (format américain)</span></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a><span class="fu">mdy</span>(<span class="st">"02/25/2025"</span>)</span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonctionne avec différents séparateurs ou sans</span></span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025.02.25"</span>)</span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"20250225"</span>)</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>Les fonctions de création de date acceptent de nombreux formats et séparateurs, ce qui facilite le nettoyage des données importées de diverses sources.</span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Intégration de l'heure</span></span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a>Pour inclure l'heure, ajoutez simplement le suffixe correspondant :</span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Année-mois-jour heure-minute-seconde</span></span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(<span class="st">"2025-02-25 14:30:45"</span>)</span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Jour-mois-année heure-minute</span></span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy_hm</span>(<span class="st">"25-02-2025 14:30"</span>)</span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Extraire et modifier les composants d'une date</span></span>
<span id="cb74-81"><a href="#cb74-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-82"><a href="#cb74-82" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extraction d'informations</span></span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'une date</span></span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>ma_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des composants</span></span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(ma_date)    <span class="co"># Année</span></span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(ma_date)   <span class="co"># Mois (numérique)</span></span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(ma_date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)  <span class="co"># Nom du mois complet</span></span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a><span class="fu">day</span>(ma_date)     <span class="co"># Jour du mois</span></span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(ma_date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">week_start =</span> <span class="dv">1</span>)  <span class="co"># Jour de la semaine (débutant lundi)</span></span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a><span class="fu">quarter</span>(ma_date) <span class="co"># Trimestre</span></span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-99"><a href="#cb74-99" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modification des composants</span></span>
<span id="cb74-100"><a href="#cb74-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Copier la date pour démonstration</span></span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a>date_modifiee <span class="ot">&lt;-</span> ma_date</span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-107"><a href="#cb74-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Modification de l'année</span></span>
<span id="cb74-108"><a href="#cb74-108" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(date_modifiee) <span class="ot">&lt;-</span> <span class="dv">2026</span></span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a>date_modifiee</span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Modification du mois (en une ligne)</span></span>
<span id="cb74-112"><a href="#cb74-112" aria-hidden="true" tabindex="-1"></a>date_modifiee <span class="ot">&lt;-</span> date_modifiee <span class="sc">%&gt;%</span> <span class="fu">month</span>(<span class="dv">5</span>)</span>
<span id="cb74-113"><a href="#cb74-113" aria-hidden="true" tabindex="-1"></a>date_modifiee</span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Arithmétique des dates</span></span>
<span id="cb74-117"><a href="#cb74-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-118"><a href="#cb74-118" aria-hidden="true" tabindex="-1"></a>L'un des grands avantages de <span class="in">`lubridate`</span> est la simplicité des opérations arithmétiques :</span>
<span id="cb74-119"><a href="#cb74-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-122"><a href="#cb74-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-123"><a href="#cb74-123" aria-hidden="true" tabindex="-1"></a>ma_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span>
<span id="cb74-124"><a href="#cb74-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-125"><a href="#cb74-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter différentes unités de temps</span></span>
<span id="cb74-126"><a href="#cb74-126" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">10</span>)</span>
<span id="cb74-127"><a href="#cb74-127" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">weeks</span>(<span class="dv">2</span>)</span>
<span id="cb74-128"><a href="#cb74-128" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">3</span>)</span>
<span id="cb74-129"><a href="#cb74-129" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="cb74-130"><a href="#cb74-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-131"><a href="#cb74-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinaison d'opérations</span></span>
<span id="cb74-132"><a href="#cb74-132" aria-hidden="true" tabindex="-1"></a>ma_date <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>)</span>
<span id="cb74-133"><a href="#cb74-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-134"><a href="#cb74-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Différence entre deux dates</span></span>
<span id="cb74-135"><a href="#cb74-135" aria-hidden="true" tabindex="-1"></a>date1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-01-15"</span>)</span>
<span id="cb74-136"><a href="#cb74-136" aria-hidden="true" tabindex="-1"></a>date2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-03-25"</span>)</span>
<span id="cb74-137"><a href="#cb74-137" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">interval</span>(date1, date2)</span>
<span id="cb74-138"><a href="#cb74-138" aria-hidden="true" tabindex="-1"></a><span class="fu">as.period</span>(interval)</span>
<span id="cb74-139"><a href="#cb74-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-140"><a href="#cb74-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-141"><a href="#cb74-141" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb74-142"><a href="#cb74-142" aria-hidden="true" tabindex="-1"></a>Attention à la différence entre <span class="in">`period`</span> et <span class="in">`duration`</span> ! </span>
<span id="cb74-143"><a href="#cb74-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`months(1)`</span> (période) : ajoute un mois calendaire (variable selon le mois)</span>
<span id="cb74-144"><a href="#cb74-144" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`dmonths(1)`</span> (durée) : ajoute exactement 30.44 jours</span>
<span id="cb74-145"><a href="#cb74-145" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb74-146"><a href="#cb74-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-149"><a href="#cb74-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-150"><a href="#cb74-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Démonstration de la différence</span></span>
<span id="cb74-151"><a href="#cb74-151" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025-01-31"</span>) <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>)  <span class="co"># Respecte le calendrier</span></span>
<span id="cb74-152"><a href="#cb74-152" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">"2025-01-31"</span>) <span class="sc">+</span> <span class="fu">dmonths</span>(<span class="dv">1</span>)  <span class="co"># Ajoute une durée fixe</span></span>
<span id="cb74-153"><a href="#cb74-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-154"><a href="#cb74-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-155"><a href="#cb74-155" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Projet pratique : Analyse des ventes d'une chaîne de magasins</span></span>
<span id="cb74-156"><a href="#cb74-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-157"><a href="#cb74-157" aria-hidden="true" tabindex="-1"></a>Maintenant, appliquons ces connaissances à un projet concret. Nous allons analyser les données de vente d'une chaîne de magasins fictive pour identifier les tendances saisonnières et les opportunités commerciales.</span>
<span id="cb74-158"><a href="#cb74-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-159"><a href="#cb74-159" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1 Génération des données de vente</span></span>
<span id="cb74-160"><a href="#cb74-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-161"><a href="#cb74-161" aria-hidden="true" tabindex="-1"></a>Commençons par créer un jeu de données réaliste :</span>
<span id="cb74-162"><a href="#cb74-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-165"><a href="#cb74-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-166"><a href="#cb74-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour générer des ventes avec patterns saisonniers</span></span>
<span id="cb74-167"><a href="#cb74-167" aria-hidden="true" tabindex="-1"></a>generer_ventes <span class="ot">&lt;-</span> <span class="cf">function</span>(n_jours, date_debut) {</span>
<span id="cb74-168"><a href="#cb74-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb74-169"><a href="#cb74-169" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-170"><a href="#cb74-170" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Séquence de dates</span></span>
<span id="cb74-171"><a href="#cb74-171" aria-hidden="true" tabindex="-1"></a>  dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(date_debut), <span class="fu">ymd</span>(date_debut) <span class="sc">+</span> <span class="fu">days</span>(n_jours <span class="sc">-</span> <span class="dv">1</span>), <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb74-172"><a href="#cb74-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-173"><a href="#cb74-173" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tendance générale à la hausse</span></span>
<span id="cb74-174"><a href="#cb74-174" aria-hidden="true" tabindex="-1"></a>  tendance <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, n_jours) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb74-175"><a href="#cb74-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-176"><a href="#cb74-176" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Saisonnalité hebdomadaire (weekend +)</span></span>
<span id="cb74-177"><a href="#cb74-177" aria-hidden="true" tabindex="-1"></a>  saisonnalite_hebdo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">wday</span>(dates) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="dv">2000</span>, <span class="dv">0</span>)</span>
<span id="cb74-178"><a href="#cb74-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-179"><a href="#cb74-179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Saisonnalité mensuelle (fin de mois +)</span></span>
<span id="cb74-180"><a href="#cb74-180" aria-hidden="true" tabindex="-1"></a>  saisonnalite_mensuelle <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">day</span>(dates) <span class="sc">&gt;=</span> <span class="dv">25</span>, <span class="dv">1000</span>, <span class="dv">0</span>)</span>
<span id="cb74-181"><a href="#cb74-181" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-182"><a href="#cb74-182" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Saisonnalité annuelle (été et Noël +)</span></span>
<span id="cb74-183"><a href="#cb74-183" aria-hidden="true" tabindex="-1"></a>  mois <span class="ot">&lt;-</span> <span class="fu">month</span>(dates)</span>
<span id="cb74-184"><a href="#cb74-184" aria-hidden="true" tabindex="-1"></a>  saisonnalite_annuelle <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb74-185"><a href="#cb74-185" aria-hidden="true" tabindex="-1"></a>    mois <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="dv">3000</span>,  <span class="co"># Été</span></span>
<span id="cb74-186"><a href="#cb74-186" aria-hidden="true" tabindex="-1"></a>    mois <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="dv">5000</span>,         <span class="co"># Noël</span></span>
<span id="cb74-187"><a href="#cb74-187" aria-hidden="true" tabindex="-1"></a>    mois <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">1000</span>,         <span class="co"># Janvier (après Noël)</span></span>
<span id="cb74-188"><a href="#cb74-188" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb74-189"><a href="#cb74-189" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-190"><a href="#cb74-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-191"><a href="#cb74-191" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Valeurs de base avec bruit aléatoire</span></span>
<span id="cb74-192"><a href="#cb74-192" aria-hidden="true" tabindex="-1"></a>  base <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb74-193"><a href="#cb74-193" aria-hidden="true" tabindex="-1"></a>  bruit <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_jours, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb74-194"><a href="#cb74-194" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-195"><a href="#cb74-195" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Génération des ventes journalières</span></span>
<span id="cb74-196"><a href="#cb74-196" aria-hidden="true" tabindex="-1"></a>  ventes <span class="ot">&lt;-</span> base <span class="sc">+</span> tendance <span class="sc">+</span> saisonnalite_hebdo <span class="sc">+</span> saisonnalite_mensuelle <span class="sc">+</span> </span>
<span id="cb74-197"><a href="#cb74-197" aria-hidden="true" tabindex="-1"></a>    saisonnalite_annuelle <span class="sc">+</span> bruit</span>
<span id="cb74-198"><a href="#cb74-198" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-199"><a href="#cb74-199" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du dataframe</span></span>
<span id="cb74-200"><a href="#cb74-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb74-201"><a href="#cb74-201" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> dates,</span>
<span id="cb74-202"><a href="#cb74-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes =</span> <span class="fu">round</span>(<span class="fu">pmax</span>(ventes, <span class="dv">0</span>)),</span>
<span id="cb74-203"><a href="#cb74-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">magasin =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Paris"</span>, <span class="st">"Lyon"</span>, <span class="st">"Marseille"</span>, <span class="st">"Bordeaux"</span>, <span class="st">"Lille"</span>), n_jours, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-204"><a href="#cb74-204" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-205"><a href="#cb74-205" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-206"><a href="#cb74-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-207"><a href="#cb74-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de deux ans de données</span></span>
<span id="cb74-208"><a href="#cb74-208" aria-hidden="true" tabindex="-1"></a>ventes <span class="ot">&lt;-</span> <span class="fu">generer_ventes</span>(<span class="dv">730</span>, <span class="st">"2023-01-01"</span>)</span>
<span id="cb74-209"><a href="#cb74-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-210"><a href="#cb74-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Aperçu des données</span></span>
<span id="cb74-211"><a href="#cb74-211" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ventes)</span>
<span id="cb74-212"><a href="#cb74-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-213"><a href="#cb74-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-214"><a href="#cb74-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2 Exploration des données temporelles</span></span>
<span id="cb74-215"><a href="#cb74-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-216"><a href="#cb74-216" aria-hidden="true" tabindex="-1"></a>Préparons les données en ajoutant des dimensions temporelles utiles :</span>
<span id="cb74-217"><a href="#cb74-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-220"><a href="#cb74-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-221"><a href="#cb74-221" aria-hidden="true" tabindex="-1"></a><span class="co"># Enrichissement des données avec composantes temporelles</span></span>
<span id="cb74-222"><a href="#cb74-222" aria-hidden="true" tabindex="-1"></a>ventes_enrichies <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb74-223"><a href="#cb74-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-224"><a href="#cb74-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">annee =</span> <span class="fu">year</span>(date),</span>
<span id="cb74-225"><a href="#cb74-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">mois =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-226"><a href="#cb74-226" aria-hidden="true" tabindex="-1"></a>    <span class="at">trimestre =</span> <span class="fu">quarter</span>(date),</span>
<span id="cb74-227"><a href="#cb74-227" aria-hidden="true" tabindex="-1"></a>    <span class="at">semaine =</span> <span class="fu">week</span>(date),</span>
<span id="cb74-228"><a href="#cb74-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">jour_semaine =</span> <span class="fu">wday</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">week_start =</span> <span class="dv">1</span>),</span>
<span id="cb74-229"><a href="#cb74-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">jour_mois =</span> <span class="fu">day</span>(date),</span>
<span id="cb74-230"><a href="#cb74-230" aria-hidden="true" tabindex="-1"></a>    <span class="at">weekend =</span> <span class="fu">ifelse</span>(<span class="fu">wday</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="st">"Weekend"</span>, <span class="st">"Semaine"</span>),</span>
<span id="cb74-231"><a href="#cb74-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">saison =</span> <span class="fu">case_when</span>(</span>
<span id="cb74-232"><a href="#cb74-232" aria-hidden="true" tabindex="-1"></a>      <span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Hiver"</span>,</span>
<span id="cb74-233"><a href="#cb74-233" aria-hidden="true" tabindex="-1"></a>      <span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Printemps"</span>,</span>
<span id="cb74-234"><a href="#cb74-234" aria-hidden="true" tabindex="-1"></a>      <span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Été"</span>,</span>
<span id="cb74-235"><a href="#cb74-235" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Automne"</span></span>
<span id="cb74-236"><a href="#cb74-236" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-237"><a href="#cb74-237" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-238"><a href="#cb74-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-239"><a href="#cb74-239" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure des données enrichies</span></span>
<span id="cb74-240"><a href="#cb74-240" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ventes_enrichies)</span>
<span id="cb74-241"><a href="#cb74-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-242"><a href="#cb74-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-243"><a href="#cb74-243" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.3 Analyse des tendances mensuelles</span></span>
<span id="cb74-244"><a href="#cb74-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-245"><a href="#cb74-245" aria-hidden="true" tabindex="-1"></a>Analysons maintenant l'évolution mensuelle des ventes :</span>
<span id="cb74-246"><a href="#cb74-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-249"><a href="#cb74-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-250"><a href="#cb74-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes mensuelles</span></span>
<span id="cb74-251"><a href="#cb74-251" aria-hidden="true" tabindex="-1"></a>ventes_mensuelles <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb74-252"><a href="#cb74-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, mois) <span class="sc">%&gt;%</span></span>
<span id="cb74-253"><a href="#cb74-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb74-254"><a href="#cb74-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb74-255"><a href="#cb74-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-256"><a href="#cb74-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb74-257"><a href="#cb74-257" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_mensuelles, <span class="fu">aes</span>(<span class="at">x =</span> mois, <span class="at">y =</span> ventes_totales, <span class="at">fill =</span> <span class="fu">factor</span>(annee))) <span class="sc">+</span></span>
<span id="cb74-258"><a href="#cb74-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb74-259"><a href="#cb74-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb74-260"><a href="#cb74-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-261"><a href="#cb74-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes mensuelles par année"</span>,</span>
<span id="cb74-262"><a href="#cb74-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mois"</span>,</span>
<span id="cb74-263"><a href="#cb74-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes totales"</span>,</span>
<span id="cb74-264"><a href="#cb74-264" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Année"</span></span>
<span id="cb74-265"><a href="#cb74-265" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-266"><a href="#cb74-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb74-267"><a href="#cb74-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb74-268"><a href="#cb74-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-269"><a href="#cb74-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-270"><a href="#cb74-270" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.4 Comparaison des jours de la semaine</span></span>
<span id="cb74-271"><a href="#cb74-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-274"><a href="#cb74-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-275"><a href="#cb74-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes par jour de semaine</span></span>
<span id="cb74-276"><a href="#cb74-276" aria-hidden="true" tabindex="-1"></a>ventes_jour_semaine <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb74-277"><a href="#cb74-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(jour_semaine, weekend) <span class="sc">%&gt;%</span></span>
<span id="cb74-278"><a href="#cb74-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_moyennes =</span> <span class="fu">mean</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb74-279"><a href="#cb74-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb74-280"><a href="#cb74-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-281"><a href="#cb74-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb74-282"><a href="#cb74-282" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_jour_semaine, <span class="fu">aes</span>(<span class="at">x =</span> jour_semaine, <span class="at">y =</span> ventes_moyennes, <span class="at">fill =</span> weekend)) <span class="sc">+</span></span>
<span id="cb74-283"><a href="#cb74-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb74-284"><a href="#cb74-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb74-285"><a href="#cb74-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-286"><a href="#cb74-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes moyennes par jour de la semaine"</span>,</span>
<span id="cb74-287"><a href="#cb74-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Jour"</span>,</span>
<span id="cb74-288"><a href="#cb74-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes moyennes"</span>,</span>
<span id="cb74-289"><a href="#cb74-289" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Type de jour"</span></span>
<span id="cb74-290"><a href="#cb74-290" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-291"><a href="#cb74-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb74-292"><a href="#cb74-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-293"><a href="#cb74-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-294"><a href="#cb74-294" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.5 Analyse des tendances saisonnières</span></span>
<span id="cb74-295"><a href="#cb74-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-298"><a href="#cb74-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-299"><a href="#cb74-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes par saison et par année</span></span>
<span id="cb74-300"><a href="#cb74-300" aria-hidden="true" tabindex="-1"></a>ventes_saison <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb74-301"><a href="#cb74-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, saison) <span class="sc">%&gt;%</span></span>
<span id="cb74-302"><a href="#cb74-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb74-303"><a href="#cb74-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb74-304"><a href="#cb74-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-305"><a href="#cb74-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Réordonner les saisons</span></span>
<span id="cb74-306"><a href="#cb74-306" aria-hidden="true" tabindex="-1"></a>ventes_saison<span class="sc">$</span>saison <span class="ot">&lt;-</span> <span class="fu">factor</span>(ventes_saison<span class="sc">$</span>saison, </span>
<span id="cb74-307"><a href="#cb74-307" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Printemps"</span>, <span class="st">"Été"</span>, <span class="st">"Automne"</span>, <span class="st">"Hiver"</span>))</span>
<span id="cb74-308"><a href="#cb74-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-309"><a href="#cb74-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb74-310"><a href="#cb74-310" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_saison, <span class="fu">aes</span>(<span class="at">x =</span> saison, <span class="at">y =</span> ventes_totales, <span class="at">fill =</span> <span class="fu">factor</span>(annee))) <span class="sc">+</span></span>
<span id="cb74-311"><a href="#cb74-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb74-312"><a href="#cb74-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb74-313"><a href="#cb74-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-314"><a href="#cb74-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes totales par saison"</span>,</span>
<span id="cb74-315"><a href="#cb74-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Saison"</span>,</span>
<span id="cb74-316"><a href="#cb74-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes totales"</span>,</span>
<span id="cb74-317"><a href="#cb74-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Année"</span></span>
<span id="cb74-318"><a href="#cb74-318" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-319"><a href="#cb74-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb74-320"><a href="#cb74-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-321"><a href="#cb74-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-322"><a href="#cb74-322" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.6 Analyse des ventes par magasin dans le temps</span></span>
<span id="cb74-323"><a href="#cb74-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-326"><a href="#cb74-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-327"><a href="#cb74-327" aria-hidden="true" tabindex="-1"></a><span class="co"># Ventes mensuelles par magasin</span></span>
<span id="cb74-328"><a href="#cb74-328" aria-hidden="true" tabindex="-1"></a>ventes_magasin <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb74-329"><a href="#cb74-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(annee, mois, magasin) <span class="sc">%&gt;%</span></span>
<span id="cb74-330"><a href="#cb74-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes)) <span class="sc">%&gt;%</span></span>
<span id="cb74-331"><a href="#cb74-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb74-332"><a href="#cb74-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-333"><a href="#cb74-333" aria-hidden="true" tabindex="-1"></a><span class="co"># Fusion année-mois pour la visualisation</span></span>
<span id="cb74-334"><a href="#cb74-334" aria-hidden="true" tabindex="-1"></a>ventes_magasin <span class="ot">&lt;-</span> ventes_magasin <span class="sc">%&gt;%</span></span>
<span id="cb74-335"><a href="#cb74-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">periode =</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(annee, <span class="st">"-"</span>, <span class="fu">as.numeric</span>(mois), <span class="st">"-01"</span>)))</span>
<span id="cb74-336"><a href="#cb74-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-337"><a href="#cb74-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb74-338"><a href="#cb74-338" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ventes_magasin, <span class="fu">aes</span>(<span class="at">x =</span> periode, <span class="at">y =</span> ventes_totales, <span class="at">color =</span> magasin)) <span class="sc">+</span></span>
<span id="cb74-339"><a href="#cb74-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb74-340"><a href="#cb74-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-341"><a href="#cb74-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>, <span class="at">date_breaks =</span> <span class="st">"2 months"</span>) <span class="sc">+</span></span>
<span id="cb74-342"><a href="#cb74-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb74-343"><a href="#cb74-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-344"><a href="#cb74-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Évolution des ventes par magasin"</span>,</span>
<span id="cb74-345"><a href="#cb74-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Période"</span>,</span>
<span id="cb74-346"><a href="#cb74-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes totales"</span>,</span>
<span id="cb74-347"><a href="#cb74-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Magasin"</span></span>
<span id="cb74-348"><a href="#cb74-348" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-349"><a href="#cb74-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb74-350"><a href="#cb74-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb74-351"><a href="#cb74-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-352"><a href="#cb74-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-353"><a href="#cb74-353" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.7 Identification de jours spéciaux</span></span>
<span id="cb74-354"><a href="#cb74-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-355"><a href="#cb74-355" aria-hidden="true" tabindex="-1"></a>Analysons les jours de vente exceptionnels :</span>
<span id="cb74-356"><a href="#cb74-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-359"><a href="#cb74-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-360"><a href="#cb74-360" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des jours exceptionnels (ventes supérieures à la moyenne + 2 écarts-types)</span></span>
<span id="cb74-361"><a href="#cb74-361" aria-hidden="true" tabindex="-1"></a>moyenne_ventes <span class="ot">&lt;-</span> <span class="fu">mean</span>(ventes_enrichies<span class="sc">$</span>ventes)</span>
<span id="cb74-362"><a href="#cb74-362" aria-hidden="true" tabindex="-1"></a>ecart_type_ventes <span class="ot">&lt;-</span> <span class="fu">sd</span>(ventes_enrichies<span class="sc">$</span>ventes)</span>
<span id="cb74-363"><a href="#cb74-363" aria-hidden="true" tabindex="-1"></a>seuil_exceptionnel <span class="ot">&lt;-</span> moyenne_ventes <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> ecart_type_ventes</span>
<span id="cb74-364"><a href="#cb74-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-365"><a href="#cb74-365" aria-hidden="true" tabindex="-1"></a>jours_exceptionnels <span class="ot">&lt;-</span> ventes_enrichies <span class="sc">%&gt;%</span></span>
<span id="cb74-366"><a href="#cb74-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ventes <span class="sc">&gt;</span> seuil_exceptionnel) <span class="sc">%&gt;%</span></span>
<span id="cb74-367"><a href="#cb74-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ventes))</span>
<span id="cb74-368"><a href="#cb74-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-369"><a href="#cb74-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des 10 meilleurs jours de vente</span></span>
<span id="cb74-370"><a href="#cb74-370" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb74-371"><a href="#cb74-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(jours_exceptionnels <span class="sc">%&gt;%</span> </span>
<span id="cb74-372"><a href="#cb74-372" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(date, jour_semaine, mois, ventes, magasin), <span class="dv">10</span>),</span>
<span id="cb74-373"><a href="#cb74-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Top 10 des jours de vente exceptionnels"</span>,</span>
<span id="cb74-374"><a href="#cb74-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">" "</span>)</span>
<span id="cb74-375"><a href="#cb74-375" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-376"><a href="#cb74-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-377"><a href="#cb74-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-378"><a href="#cb74-378" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.8 Analyse des intervalles entre pics de vente</span></span>
<span id="cb74-379"><a href="#cb74-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-382"><a href="#cb74-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-383"><a href="#cb74-383" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalles entre jours exceptionnels</span></span>
<span id="cb74-384"><a href="#cb74-384" aria-hidden="true" tabindex="-1"></a>jours_pic <span class="ot">&lt;-</span> jours_exceptionnels <span class="sc">%&gt;%</span></span>
<span id="cb74-385"><a href="#cb74-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb74-386"><a href="#cb74-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(date)</span>
<span id="cb74-387"><a href="#cb74-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-388"><a href="#cb74-388" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des intervalles (en jours)</span></span>
<span id="cb74-389"><a href="#cb74-389" aria-hidden="true" tabindex="-1"></a>intervalles <span class="ot">&lt;-</span> <span class="fu">diff</span>(jours_pic)</span>
<span id="cb74-390"><a href="#cb74-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-391"><a href="#cb74-391" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques sur les intervalles</span></span>
<span id="cb74-392"><a href="#cb74-392" aria-hidden="true" tabindex="-1"></a>resume_intervalles <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-393"><a href="#cb74-393" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_min =</span> <span class="fu">min</span>(intervalles),</span>
<span id="cb74-394"><a href="#cb74-394" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_median =</span> <span class="fu">median</span>(intervalles),</span>
<span id="cb74-395"><a href="#cb74-395" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_moyen =</span> <span class="fu">mean</span>(intervalles),</span>
<span id="cb74-396"><a href="#cb74-396" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle_max =</span> <span class="fu">max</span>(intervalles)</span>
<span id="cb74-397"><a href="#cb74-397" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-398"><a href="#cb74-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-399"><a href="#cb74-399" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(resume_intervalles, </span>
<span id="cb74-400"><a href="#cb74-400" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Statistiques sur les intervalles entre pics de vente (en jours)"</span>)</span>
<span id="cb74-401"><a href="#cb74-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-402"><a href="#cb74-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-403"><a href="#cb74-403" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.9 Prévision simple basée sur les tendances historiques</span></span>
<span id="cb74-404"><a href="#cb74-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-405"><a href="#cb74-405" aria-hidden="true" tabindex="-1"></a>Nous pouvons utiliser lubridate pour extrapoler les ventes futures en nous basant sur les patterns saisonniers identifiés :</span>
<span id="cb74-406"><a href="#cb74-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-409"><a href="#cb74-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-410"><a href="#cb74-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de dates futures pour prévision</span></span>
<span id="cb74-411"><a href="#cb74-411" aria-hidden="true" tabindex="-1"></a>dates_futures <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">max</span>(ventes<span class="sc">$</span>date) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>), </span>
<span id="cb74-412"><a href="#cb74-412" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">max</span>(ventes<span class="sc">$</span>date) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">30</span>), <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb74-413"><a href="#cb74-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-414"><a href="#cb74-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation du dataframe pour les prévisions</span></span>
<span id="cb74-415"><a href="#cb74-415" aria-hidden="true" tabindex="-1"></a>previsions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-416"><a href="#cb74-416" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> dates_futures,</span>
<span id="cb74-417"><a href="#cb74-417" aria-hidden="true" tabindex="-1"></a>  <span class="at">jour_semaine =</span> <span class="fu">wday</span>(dates_futures, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-418"><a href="#cb74-418" aria-hidden="true" tabindex="-1"></a>  <span class="at">mois =</span> <span class="fu">month</span>(dates_futures, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb74-419"><a href="#cb74-419" aria-hidden="true" tabindex="-1"></a>  <span class="at">jour_mois =</span> <span class="fu">day</span>(dates_futures)</span>
<span id="cb74-420"><a href="#cb74-420" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-421"><a href="#cb74-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-422"><a href="#cb74-422" aria-hidden="true" tabindex="-1"></a><span class="co"># Application des facteurs saisonniers identifiés</span></span>
<span id="cb74-423"><a href="#cb74-423" aria-hidden="true" tabindex="-1"></a>previsions <span class="ot">&lt;-</span> previsions <span class="sc">%&gt;%</span></span>
<span id="cb74-424"><a href="#cb74-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-425"><a href="#cb74-425" aria-hidden="true" tabindex="-1"></a>    <span class="at">facteur_weekend =</span> <span class="fu">ifelse</span>(<span class="fu">wday</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="fl">1.2</span>, <span class="dv">1</span>),</span>
<span id="cb74-426"><a href="#cb74-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">facteur_fin_mois =</span> <span class="fu">ifelse</span>(jour_mois <span class="sc">&gt;=</span> <span class="dv">25</span>, <span class="fl">1.1</span>, <span class="dv">1</span>),</span>
<span id="cb74-427"><a href="#cb74-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">facteur_mois =</span> <span class="fu">case_when</span>(</span>
<span id="cb74-428"><a href="#cb74-428" aria-hidden="true" tabindex="-1"></a>      mois <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"juil."</span>, <span class="st">"août"</span>) <span class="sc">~</span> <span class="fl">1.3</span>,</span>
<span id="cb74-429"><a href="#cb74-429" aria-hidden="true" tabindex="-1"></a>      mois <span class="sc">==</span> <span class="st">"déc."</span> <span class="sc">~</span> <span class="fl">1.5</span>,</span>
<span id="cb74-430"><a href="#cb74-430" aria-hidden="true" tabindex="-1"></a>      mois <span class="sc">==</span> <span class="st">"janv."</span> <span class="sc">~</span> <span class="fl">0.9</span>,</span>
<span id="cb74-431"><a href="#cb74-431" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb74-432"><a href="#cb74-432" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb74-433"><a href="#cb74-433" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_prevues =</span> <span class="dv">15000</span> <span class="sc">*</span> facteur_weekend <span class="sc">*</span> facteur_fin_mois <span class="sc">*</span> facteur_mois</span>
<span id="cb74-434"><a href="#cb74-434" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-435"><a href="#cb74-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-436"><a href="#cb74-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Aperçu des prévisions</span></span>
<span id="cb74-437"><a href="#cb74-437" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb74-438"><a href="#cb74-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(previsions <span class="sc">%&gt;%</span> </span>
<span id="cb74-439"><a href="#cb74-439" aria-hidden="true" tabindex="-1"></a>         <span class="fu">select</span>(date, jour_semaine, ventes_prevues), <span class="dv">10</span>),</span>
<span id="cb74-440"><a href="#cb74-440" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Prévision des ventes pour les 10 prochains jours"</span>,</span>
<span id="cb74-441"><a href="#cb74-441" aria-hidden="true" tabindex="-1"></a>  <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">" "</span>)</span>
<span id="cb74-442"><a href="#cb74-442" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-443"><a href="#cb74-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-444"><a href="#cb74-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-445"><a href="#cb74-445" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Applications pratiques avancées avec lubridate</span></span>
<span id="cb74-446"><a href="#cb74-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-447"><a href="#cb74-447" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.1 Création de périodes glissantes (rolling periods)</span></span>
<span id="cb74-448"><a href="#cb74-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-451"><a href="#cb74-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-452"><a href="#cb74-452" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des moyennes mobiles sur 7 jours</span></span>
<span id="cb74-453"><a href="#cb74-453" aria-hidden="true" tabindex="-1"></a>ventes_moyennes_mobiles <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb74-454"><a href="#cb74-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb74-455"><a href="#cb74-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-456"><a href="#cb74-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_moy_7j =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(ventes, <span class="at">k =</span> <span class="dv">7</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>),</span>
<span id="cb74-457"><a href="#cb74-457" aria-hidden="true" tabindex="-1"></a>    <span class="at">periode_debut =</span> date <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">6</span>),</span>
<span id="cb74-458"><a href="#cb74-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">periode_fin =</span> date</span>
<span id="cb74-459"><a href="#cb74-459" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-460"><a href="#cb74-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-461"><a href="#cb74-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des dernières 30 observations</span></span>
<span id="cb74-462"><a href="#cb74-462" aria-hidden="true" tabindex="-1"></a>tail_ventes <span class="ot">&lt;-</span> <span class="fu">tail</span>(ventes_moyennes_mobiles, <span class="dv">30</span>)</span>
<span id="cb74-463"><a href="#cb74-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-464"><a href="#cb74-464" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tail_ventes, <span class="fu">aes</span>(<span class="at">x =</span> date)) <span class="sc">+</span></span>
<span id="cb74-465"><a href="#cb74-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ventes), <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb74-466"><a href="#cb74-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ventes_moy_7j), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb74-467"><a href="#cb74-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)) <span class="sc">+</span></span>
<span id="cb74-468"><a href="#cb74-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-469"><a href="#cb74-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ventes quotidiennes vs. moyenne mobile sur 7 jours"</span>,</span>
<span id="cb74-470"><a href="#cb74-470" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"30 derniers jours d'observation"</span>,</span>
<span id="cb74-471"><a href="#cb74-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb74-472"><a href="#cb74-472" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ventes"</span></span>
<span id="cb74-473"><a href="#cb74-473" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-474"><a href="#cb74-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb74-475"><a href="#cb74-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-476"><a href="#cb74-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-477"><a href="#cb74-477" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.2 Calcul d'intervalles entre événements</span></span>
<span id="cb74-478"><a href="#cb74-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-481"><a href="#cb74-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-482"><a href="#cb74-482" aria-hidden="true" tabindex="-1"></a><span class="co"># Identification des jours où les ventes dépassent 20 000 €</span></span>
<span id="cb74-483"><a href="#cb74-483" aria-hidden="true" tabindex="-1"></a>jours_20k <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb74-484"><a href="#cb74-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ventes <span class="sc">&gt;</span> <span class="dv">20000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-485"><a href="#cb74-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb74-486"><a href="#cb74-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(date)</span>
<span id="cb74-487"><a href="#cb74-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-488"><a href="#cb74-488" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des intervalles entre ces jours</span></span>
<span id="cb74-489"><a href="#cb74-489" aria-hidden="true" tabindex="-1"></a>intervalles_20k <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-490"><a href="#cb74-490" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_debut =</span> <span class="fu">head</span>(jours_20k, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb74-491"><a href="#cb74-491" aria-hidden="true" tabindex="-1"></a>  <span class="at">date_fin =</span> <span class="fu">tail</span>(jours_20k, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb74-492"><a href="#cb74-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervalle =</span> <span class="fu">as.numeric</span>(<span class="fu">diff</span>(jours_20k))</span>
<span id="cb74-493"><a href="#cb74-493" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-494"><a href="#cb74-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-495"><a href="#cb74-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des 5 premiers intervalles</span></span>
<span id="cb74-496"><a href="#cb74-496" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb74-497"><a href="#cb74-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(intervalles_20k, <span class="dv">5</span>),</span>
<span id="cb74-498"><a href="#cb74-498" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Intervalles (en jours) entre les ventes dépassant 20 000 €"</span></span>
<span id="cb74-499"><a href="#cb74-499" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-500"><a href="#cb74-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-501"><a href="#cb74-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-502"><a href="#cb74-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.3 Analyse par saison commerciale</span></span>
<span id="cb74-503"><a href="#cb74-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-504"><a href="#cb74-504" aria-hidden="true" tabindex="-1"></a>Définissons des saisons commerciales personnalisées et analysons les performances :</span>
<span id="cb74-505"><a href="#cb74-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-508"><a href="#cb74-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-509"><a href="#cb74-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des périodes commerciales</span></span>
<span id="cb74-510"><a href="#cb74-510" aria-hidden="true" tabindex="-1"></a>periodes_commerciales <span class="ot">&lt;-</span> <span class="cf">function</span>(date) {</span>
<span id="cb74-511"><a href="#cb74-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb74-512"><a href="#cb74-512" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span> <span class="fu">day</span>(date) <span class="sc">&gt;=</span> <span class="dv">25</span>) <span class="sc">|</span> </span>
<span id="cb74-513"><a href="#cb74-513" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">month</span>(date) <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span> <span class="fu">day</span>(date) <span class="sc">&lt;=</span> <span class="dv">31</span>) <span class="sc">~</span> <span class="st">"Fêtes de fin d'année"</span>,</span>
<span id="cb74-514"><a href="#cb74-514" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> <span class="fu">month</span>(date) <span class="sc">&lt;=</span> <span class="dv">8</span>) <span class="sc">~</span> <span class="st">"Période estivale"</span>,</span>
<span id="cb74-515"><a href="#cb74-515" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">month</span>(date) <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Soldes d'hiver"</span>,</span>
<span id="cb74-516"><a href="#cb74-516" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">month</span>(date) <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> <span class="fu">month</span>(date) <span class="sc">&lt;=</span> <span class="dv">7</span> <span class="sc">&amp;</span> <span class="fu">day</span>(date) <span class="sc">&lt;=</span> <span class="dv">15</span>) <span class="sc">~</span> <span class="st">"Soldes d'été"</span>,</span>
<span id="cb74-517"><a href="#cb74-517" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Période normale"</span></span>
<span id="cb74-518"><a href="#cb74-518" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-519"><a href="#cb74-519" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-520"><a href="#cb74-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-521"><a href="#cb74-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Application à nos données</span></span>
<span id="cb74-522"><a href="#cb74-522" aria-hidden="true" tabindex="-1"></a>ventes_periodes <span class="ot">&lt;-</span> ventes <span class="sc">%&gt;%</span></span>
<span id="cb74-523"><a href="#cb74-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">periode_commerciale =</span> <span class="fu">periodes_commerciales</span>(date))</span>
<span id="cb74-524"><a href="#cb74-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-525"><a href="#cb74-525" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse des ventes par période commerciale</span></span>
<span id="cb74-526"><a href="#cb74-526" aria-hidden="true" tabindex="-1"></a>resume_periodes <span class="ot">&lt;-</span> ventes_periodes <span class="sc">%&gt;%</span></span>
<span id="cb74-527"><a href="#cb74-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(periode_commerciale) <span class="sc">%&gt;%</span></span>
<span id="cb74-528"><a href="#cb74-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb74-529"><a href="#cb74-529" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_totales =</span> <span class="fu">sum</span>(ventes),</span>
<span id="cb74-530"><a href="#cb74-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">ventes_moyennes =</span> <span class="fu">mean</span>(ventes),</span>
<span id="cb74-531"><a href="#cb74-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_jours =</span> <span class="fu">n</span>()</span>
<span id="cb74-532"><a href="#cb74-532" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb74-533"><a href="#cb74-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ventes_moyennes))</span>
<span id="cb74-534"><a href="#cb74-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-535"><a href="#cb74-535" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation</span></span>
<span id="cb74-536"><a href="#cb74-536" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb74-537"><a href="#cb74-537" aria-hidden="true" tabindex="-1"></a>  resume_periodes,</span>
<span id="cb74-538"><a href="#cb74-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Performance des ventes par période commerciale"</span>,</span>
<span id="cb74-539"><a href="#cb74-539" aria-hidden="true" tabindex="-1"></a>  <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">" "</span>)</span>
<span id="cb74-540"><a href="#cb74-540" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-541"><a href="#cb74-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-542"><a href="#cb74-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-543"><a href="#cb74-543" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Conseils pratiques pour travailler avec les dates</span></span>
<span id="cb74-544"><a href="#cb74-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-545"><a href="#cb74-545" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1 Formatage des dates pour affichage</span></span>
<span id="cb74-546"><a href="#cb74-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-549"><a href="#cb74-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-550"><a href="#cb74-550" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemples de formatage</span></span>
<span id="cb74-551"><a href="#cb74-551" aria-hidden="true" tabindex="-1"></a>ma_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2025-02-25"</span>)</span>
<span id="cb74-552"><a href="#cb74-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-553"><a href="#cb74-553" aria-hidden="true" tabindex="-1"></a>formats <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb74-554"><a href="#cb74-554" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%d/%m/%Y"</span>, </span>
<span id="cb74-555"><a href="#cb74-555" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%A %d %B %Y"</span>, </span>
<span id="cb74-556"><a href="#cb74-556" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%d %b %Y"</span>, </span>
<span id="cb74-557"><a href="#cb74-557" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Semaine %U, %Y"</span></span>
<span id="cb74-558"><a href="#cb74-558" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-559"><a href="#cb74-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-560"><a href="#cb74-560" aria-hidden="true" tabindex="-1"></a><span class="co"># Application des différents formats</span></span>
<span id="cb74-561"><a href="#cb74-561" aria-hidden="true" tabindex="-1"></a>formats_affiches <span class="ot">&lt;-</span> <span class="fu">sapply</span>(formats, <span class="cf">function</span>(fmt) <span class="fu">format</span>(ma_date, fmt))</span>
<span id="cb74-562"><a href="#cb74-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-563"><a href="#cb74-563" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb74-564"><a href="#cb74-564" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb74-565"><a href="#cb74-565" aria-hidden="true" tabindex="-1"></a>  <span class="at">Format =</span> formats,</span>
<span id="cb74-566"><a href="#cb74-566" aria-hidden="true" tabindex="-1"></a>  Résultat <span class="ot">=</span> formats_affiches</span>
<span id="cb74-567"><a href="#cb74-567" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-568"><a href="#cb74-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-569"><a href="#cb74-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-570"><a href="#cb74-570" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2 Gestion des fuseaux horaires</span></span>
<span id="cb74-571"><a href="#cb74-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-574"><a href="#cb74-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-575"><a href="#cb74-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'une date avec heure et fuseau horaire</span></span>
<span id="cb74-576"><a href="#cb74-576" aria-hidden="true" tabindex="-1"></a>date_paris <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2025-02-25 14:30:00"</span>, <span class="at">tz =</span> <span class="st">"Europe/Paris"</span>)</span>
<span id="cb74-577"><a href="#cb74-577" aria-hidden="true" tabindex="-1"></a>date_paris</span>
<span id="cb74-578"><a href="#cb74-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-579"><a href="#cb74-579" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion vers d'autres fuseaux horaires</span></span>
<span id="cb74-580"><a href="#cb74-580" aria-hidden="true" tabindex="-1"></a>date_ny <span class="ot">&lt;-</span> <span class="fu">with_tz</span>(date_paris, <span class="at">tzone =</span> <span class="st">"America/New_York"</span>)</span>
<span id="cb74-581"><a href="#cb74-581" aria-hidden="true" tabindex="-1"></a>date_tokyo <span class="ot">&lt;-</span> <span class="fu">with_tz</span>(date_paris, <span class="at">tzone =</span> <span class="st">"Asia/Tokyo"</span>)</span>
<span id="cb74-582"><a href="#cb74-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-583"><a href="#cb74-583" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison</span></span>
<span id="cb74-584"><a href="#cb74-584" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb74-585"><a href="#cb74-585" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ville =</span> <span class="fu">c</span>(<span class="st">"Paris"</span>, <span class="st">"New York"</span>, <span class="st">"Tokyo"</span>),</span>
<span id="cb74-586"><a href="#cb74-586" aria-hidden="true" tabindex="-1"></a>  <span class="at">Heure_locale =</span> <span class="fu">c</span>(</span>
<span id="cb74-587"><a href="#cb74-587" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_paris, <span class="st">"%H:%M:%S"</span>),</span>
<span id="cb74-588"><a href="#cb74-588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_ny, <span class="st">"%H:%M:%S"</span>),</span>
<span id="cb74-589"><a href="#cb74-589" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_tokyo, <span class="st">"%H:%M:%S"</span>)</span>
<span id="cb74-590"><a href="#cb74-590" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb74-591"><a href="#cb74-591" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">c</span>(</span>
<span id="cb74-592"><a href="#cb74-592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_paris, <span class="st">"%d %b %Y"</span>),</span>
<span id="cb74-593"><a href="#cb74-593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_ny, <span class="st">"%d %b %Y"</span>),</span>
<span id="cb74-594"><a href="#cb74-594" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(date_tokyo, <span class="st">"%d %b %Y"</span>)</span>
<span id="cb74-595"><a href="#cb74-595" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb74-596"><a href="#cb74-596" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fuseau =</span> <span class="fu">c</span>(<span class="fu">tz</span>(date_paris), <span class="fu">tz</span>(date_ny), <span class="fu">tz</span>(date_tokyo))</span>
<span id="cb74-597"><a href="#cb74-597" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-598"><a href="#cb74-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-599"><a href="#cb74-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-600"><a href="#cb74-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.3 Traitement des données manquantes dans les dates</span></span>
<span id="cb74-601"><a href="#cb74-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-604"><a href="#cb74-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb74-605"><a href="#cb74-605" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemple de dates avec valeurs manquantes</span></span>
<span id="cb74-606"><a href="#cb74-606" aria-hidden="true" tabindex="-1"></a>dates_avec_na <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"2025-02-25"</span>, <span class="cn">NA</span>, <span class="st">"2025-03-01"</span>)</span>
<span id="cb74-607"><a href="#cb74-607" aria-hidden="true" tabindex="-1"></a>dates_parsees <span class="ot">&lt;-</span> <span class="fu">ymd</span>(dates_avec_na)</span>
<span id="cb74-608"><a href="#cb74-608" aria-hidden="true" tabindex="-1"></a>dates_parsees</span>
<span id="cb74-609"><a href="#cb74-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-610"><a href="#cb74-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification des NA</span></span>
<span id="cb74-611"><a href="#cb74-611" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(dates_parsees)</span>
<span id="cb74-612"><a href="#cb74-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-613"><a href="#cb74-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrage des NA</span></span>
<span id="cb74-614"><a href="#cb74-614" aria-hidden="true" tabindex="-1"></a>dates_parsees[<span class="sc">!</span><span class="fu">is.na</span>(dates_parsees)]</span>
<span id="cb74-615"><a href="#cb74-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb74-616"><a href="#cb74-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-617"><a href="#cb74-617" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7. Conclusion et bonnes pratiques</span></span>
<span id="cb74-618"><a href="#cb74-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-619"><a href="#cb74-619" aria-hidden="true" tabindex="-1"></a>Le package <span class="in">`lubridate`</span> offre une approche intuitive et puissante pour manipuler les dates en R, ce qui est essentiel pour l'analyse de données commerciales. Voici quelques bonnes pratiques à retenir :</span>
<span id="cb74-620"><a href="#cb74-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-621"><a href="#cb74-621" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Cohérence des formats** : Standardisez vos dates dès l'importation des données</span>
<span id="cb74-622"><a href="#cb74-622" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Enrichissez vos données** : Ajoutez des dimensions temporelles pertinentes (jour de semaine, mois, saison...)</span>
<span id="cb74-623"><a href="#cb74-623" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Attention aux fuseaux horaires** : Soyez explicite dans leur gestion, surtout pour les données internationales</span>
<span id="cb74-624"><a href="#cb74-624" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Pensez en périodes** : Utilisez les concepts de <span class="in">`period`</span> et <span class="in">`duration`</span> selon vos besoins</span>
<span id="cb74-625"><a href="#cb74-625" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Évitez les calculs manuels** : Utilisez les fonctions spécialisées (<span class="in">`interval`</span>, <span class="in">`time_length`</span>, etc.)</span>
<span id="cb74-626"><a href="#cb74-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-627"><a href="#cb74-627" aria-hidden="true" tabindex="-1"></a><span class="fu">### Points clés à retenir</span></span>
<span id="cb74-628"><a href="#cb74-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-629"><a href="#cb74-629" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Création de dates** : <span class="in">`ymd()`</span>, <span class="in">`dmy()`</span>, <span class="in">`mdy()`</span></span>
<span id="cb74-630"><a href="#cb74-630" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Extraction de composants** : <span class="in">`year()`</span>, <span class="in">`month()`</span>, <span class="in">`day()`</span>, <span class="in">`wday()`</span></span>
<span id="cb74-631"><a href="#cb74-631" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Opérations arithmétiques** : <span class="in">`+ days()`</span>, <span class="in">`+ months()`</span>, <span class="in">`+ years()`</span></span>
<span id="cb74-632"><a href="#cb74-632" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Intervalles** : <span class="in">`interval()`</span>, <span class="in">`as.period()`</span>, <span class="in">`time_length()`</span></span>
<span id="cb74-633"><a href="#cb74-633" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Arrondis** : <span class="in">`round_date()`</span>, <span class="in">`floor_date()`</span>, <span class="in">`ceiling_date()`</span></span>
<span id="cb74-634"><a href="#cb74-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-635"><a href="#cb74-635" aria-hidden="true" tabindex="-1"></a>Maîtriser ces fonctions vous permettra d'analyser efficacement la dimension temporelle de vos données commerciales et d'en extraire des insights précieux pour votre entreprise.</span>
<span id="cb74-636"><a href="#cb74-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-637"><a href="#cb74-637" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pour aller plus loin</span></span>
<span id="cb74-638"><a href="#cb74-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-639"><a href="#cb74-639" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>La <span class="co">[</span><span class="ot">documentation officielle de lubridate</span><span class="co">](https://lubridate.tidyverse.org/)</span></span>
<span id="cb74-640"><a href="#cb74-640" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Le livre <span class="co">[</span><span class="ot">R for Data Science</span><span class="co">](https://r4ds.hadley.nz/)</span> de Hadley Wickham</span>
<span id="cb74-641"><a href="#cb74-641" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Les packages complémentaires : <span class="in">`tsibble`</span> pour les séries temporelles, <span class="in">`timetk`</span> pour l'analyse temporelle avancée</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>